function FormBody(){function a(){var a=f.querySelectorAll(".fl-component");return[].slice.call(a)}function b(){var b=[],c=a();return c.forEach(function(a){var c=a.getBoundingClientRect().top;b.push(c)}),b}function c(){var b=a();b.forEach(function(a){a.style.transform="translate3d(0, 0, 0)"})}function d(a,b,c,d){var e,f=(c.getBoundingClientRect().bottom,c.getBoundingClientRect().top),g=c.clientHeight,h=d>f;if(h)for(e=0;a[e];)f<a[e+1]&&a[e]<d?b[e].style.transform="translate3d(0, "+g+"px, 0)":b[e].style.transform="translate3d(0, 0, 0)",e++;else for(e=0;a[e];)f>a[e]&&a[e]>d?b[e].style.transform="translate3d(0, -"+g+"px, 0)":b[e].style.transform="translate3d(0, 0, 0)",e++}function e(e){var f=e.element.querySelector(".fl-component-side-control");if(!f)throw new Error("FormBody.addReorderButton(): No side control bar defined");var g=document.createElement("i");g.classList.add("glyphicon"),g.classList.add("glyphicon-menu-hamburger"),g.setAttribute("draggable",!0),e.dragvars={},g.addEventListener("dragstart",function(c){c.dataTransfer.setDragImage(document.createElement("img"),0,0),e.element.classList.add("fl-dragging"),e.element.dataset.yStart=c.pageY,e.dragvars.initialTop=e.element.getBoundingClientRect().top,e.dragvars.elements=a(),e.dragvars.tops=b()});var h=50;g.addEventListener("dragend",function(a){setTimeout(function(){c(),e.element.style.transform="translate3d(0, 0, 0)",e.element.dataset.yStart=a.pageY,e.element.classList.remove("fl-dragging"),e.dragvars.initialTop=null},h)}),g.addEventListener("drag",utils.throttle(h,function(a){console.log("dragging"),d(e.dragvars.tops,e.dragvars.elements,e.element,e.dragvars.initialTop);var b=e.element.dataset.yStart,c=a.pageY;if(0!==c){var f=c-b;e.element.style.transform="translate3d(0, "+f+"px, 0)"}})),f.children.length>0?f.insertBefore(g,f.children[0]):f.appendChild(g)}if(!(this instanceof FormBody))return new FormBody;var f,g,h=[];this.addComponent=function(a){return f?a?(e(a),h.push(a),f.insertBefore(a.element,g),a.configToggle(!0),void 0):void console.error("FormBody: No element to be added included."):void console.error("FormBody: Form not initialised.")},this.init=function(){f=document.createElement("form"),f.classList.add("form-horizontal"),f.addEventListener("submit",function(a){a.preventDefault(),console.log("Submit button clicked."),console.dir(h)});var a=this;f.addEventListener("newElement",function(b){return b.detail?void a.addComponent(b.detail.comp):void console.error('No data in "newElement" event.')}),g=document.createElement("input"),g.setAttribute("type","submit"),g.classList.add("btn"),g.classList.add("col-sm-12"),f.appendChild(g),this.element=f},this.init()}function FormComponent(){return this instanceof FormComponent?void 0:new FormComponent}function FormFabric(a){function b(a,b){var c="Temp name"+Math.floor(1e3*Math.random()),d=new a(c),e=new CustomEvent("newElement",{detail:{comp:d},bubbles:!0,cancelable:!0});b.dispatchEvent(e)}function c(){var c=document.createDocumentFragment();return d.forEach(function(e,f){var g=document.createElement("button");g.setAttribute("value",f),g.className=e["class"],g.classList.add("btn"),g.classList.add("btn-default"),g.addEventListener("click",function(c){var e=g.value;console.log("Create a ",d[e].desc),b(d[e].constr,a)}),c.appendChild(g)}),c}if(!(this instanceof FormFabric))return new FormFabric;var d=[{desc:"Radio buttons",constr:RadioBtns,"class":"glyphicon glyphicon-ok-circle"},{desc:"Checkboxes",constr:Checkboxes,"class":"glyphicon glyphicon-check"},{desc:"Dropdown",constr:Dropdown,"class":"glyphicon glyphicon-collapse-down"},{desc:"Text box",constr:TextBox,"class":"glyphicon glyphicon-text-width"},{desc:"Text area",constr:TextArea,"class":"glyphicon glyphicon-text-height"}];this.init=function(){this.element=document.createElement("div"),this.element.classList.add("fl-form-fabric");var a=c();this.element.appendChild(a)},this.init(a)}function Checkboxes(a){return this instanceof Checkboxes?void this.init(a):new Checkboxes}function Dropdown(a){return this instanceof Dropdown?void this.init(a):new Dropdown}function RadioBtns(a){return this instanceof RadioBtns?void this.init(a):new RadioBtns}function TextArea(a){return this instanceof TextArea?void this.init(a):new TextArea}function TextBox(a){return this instanceof TextBox?void this.init(a):new TextBox}FormComponent.prototype.init=function(a){if("string"!=typeof a)throw new Error("FormComponent: "+a+' is not a valid "name" parameter.');this.element=document.createElement("div"),this.element.classList.add("fl-component"),this.element.classList.add("col-md-12"),this.element.classList.add("form-group"),this.content=document.createElement("div"),this.content.classList.add("fl-form-content"),this.element.appendChild(this.content);var b=document.createElement("h3");b.innerText="Add a title",b.classList.add("fl-editable"),this.title=b,this.content.appendChild(b),this.name=a,this.createControls()},FormComponent.prototype.createControls=function(){var a=document.createElement("div");a.classList.add("fl-component-side-control");var b=document.createElement("button");b.setAttribute("type","button"),b.classList.add("glyphicon"),b.classList.add("glyphicon-cog"),a.appendChild(b);var c=this;b.addEventListener("click",function(){c.configToggle()});var d=document.createElement("div");d.classList.add("fl-component-config"),this.configBox=d;var e=document.createElement("div");e.classList.add("full-width"),this.configContent=e,d.appendChild(e);var f=document.createElement("div");f.classList.add("col-sm-12");var g=document.createElement("button");g.setAttribute("type","button"),g.classList.add("btn"),g.classList.add("btn-danger"),g.classList.add("btn-sm"),g.classList.add("fl-bottom-btn"),g.classList.add("glyphicon"),g.classList.add("glyphicon-trash"),g.addEventListener("click",function(){c.destroy()}),f.appendChild(g);var h=document.createElement("button");h.setAttribute("type","button"),h.classList.add("btn"),h.classList.add("btn-default"),h.classList.add("btn-sm"),h.classList.add("fl-bottom-btn"),h.classList.add("glyphicon"),h.classList.add("glyphicon-ok"),h.addEventListener("click",function(){c.saveConfig(),c.configToggle()}),f.appendChild(h);var i=document.createElement("label");i.innerText="Required";var j=document.createElement("div");j.classList.add("switch");var k=document.createElement("input");k.classList.add("cmn-toggle"),k.classList.add("cmn-toggle-round"),k.setAttribute("type","checkbox"),k.id="cmn-toggle-"+Date.now(),k.addEventListener("change",function(a){var b=a.target.checked;c.required(b)}),this.requiredSwitch=k,j.appendChild(k);var l=document.createElement("label");l.setAttribute("for",k.id),j.appendChild(l),i.appendChild(j),f.appendChild(i),d.appendChild(f),this.element.appendChild(d),this.element.appendChild(a)},FormComponent.prototype.configToggle=function(a){a=a||!this.configShowing,a?this.showConfig():this.hideConfig()},FormComponent.prototype.hideConfig=function(){if(!this.configBox)throw new Error("FormComponent.configToggle(): No configBox initialised");if(this.configShowing){this.element.classList.remove("fl-form-config-visible"),this.configShowing=!1;var a=this.element.querySelectorAll(".fl-editable"),b="Set a placeholder text.";[].forEach.call(a,function(a){if(a.setAttribute("contenteditable",!1),"TEXTAREA"===a.nodeName||"INPUT"===a.nodeName&&"text"===a.type){var c=a.getAttribute("placeholder"),d=a.value;d?a.setAttribute("placeholder",d):c===b&&a.removeAttribute("placeholder"),a.value=""}})}},FormComponent.prototype.showConfig=function(){if(!this.configBox)throw new Error("FormComponent.showConfing(): No configBox initialised");if(!this.configShowing){this.element.classList.add("fl-form-config-visible"),this.configShowing=!0;var a=this.element.querySelectorAll(".fl-editable"),b="Set a placeholder text.";[].forEach.call(a,function(a){if(a.setAttribute("contenteditable",!0),"TEXTAREA"===a.nodeName||"INPUT"===a.nodeName&&"text"===a.type){var c=a.getAttribute("placeholder"),d=c?c:b;a.setAttribute("placeholder",d),a.value=""}});var c=this.focusElement||this.configBox.querySelector("switch");c&&setTimeout(function(){c.focus()},15);var d=this,e=document.body,f=!0;e.addEventListener("mousedown",function g(a){var b=g,c=a.clientX,h=a.clientY;d.isAtPoint(c,h)||(e.removeEventListener("mousedown",b,f),d.hideConfig())},f)}},FormComponent.prototype.isAtPoint=function(a,b){var c=this.configBox.getBoundingClientRect(),d=this.element.getBoundingClientRect(),e=d.top,f=c.bottom,g=Math.max(c.right,d.right),h=Math.min(c.left,d.left);return!(h>a||a>g||e>b||b>f)},FormComponent.prototype.createConfigInputField=function(a){var b=document.createElement("input");b.setAttribute("placeholder",a||"Type a new option"),b.setAttribute("type","text"),this.focusElement=b;var c=document.createElement("i");c.classList.add("glyphicon"),c.classList.add("glyphicon-plus-sign"),c.classList.add("fl-grey-btn");var d=this;c.addEventListener("click",function(){return b.value.trim()?(d.add(b.value),void(b.value="")):void utils.blinkRed(b)}),b.addEventListener("keypress",function(a){if(13===a.which){var b=new Event("click");return c.dispatchEvent(b),a.preventDefault(),!1}return!0}),this.configContent.appendChild(c),this.configContent.appendChild(b)},FormComponent.prototype.saveConfig=function(){},FormComponent.prototype.destroy=function(){this.element.remove()},FormComponent.prototype.required=function(a){var b=this.content.querySelectorAll("input"),c=this.content.querySelectorAll("textarea");b=[].slice.call(b),c=[].slice.call(c);var d=[].concat.call(b,c);return a?d.forEach(function(a){a.setAttribute("required",!0)}):d.forEach(function(a){a.removeAttribute("required")}),!0},FormComponent.prototype.addPlaceHolder=function(){this.placeHolder=this.add("placeholder","Insert an option"),this.placeHolder.setAttribute("disabled",!0)},FormComponent.prototype.removePlaceHolder=function(){this.placeHolder.remove(),this.placeHolder=null},Checkboxes.prototype=new FormComponent,Checkboxes.prototype.init=function(a){this.constructor.prototype.init.call(this,a),this.name=a+"[]",this.isRequired=!1,this.addPlaceHolder()},Checkboxes.prototype.add=function(a,b){if(!a)throw new Error("Checkboxes.add(): No value parameter provided.");this.placeHolder&&this.removePlaceHolder(),this.isRequired&&this.getElements().length>0&&this.required(!1);var c=document.createElement("input");c.setAttribute("type","checkbox"),c.setAttribute("name",this.name),c.setAttribute("value",a),c.classList.add("fl-check-box"),this.isRequired&&c.setAttribute("required",!0);var d=document.createElement("span");d.innerText=b||a,d.classList.add("fl-editable"),d.setAttribute("contenteditable",!0);var e=document.createElement("label");return e.appendChild(c),e.appendChild(d),this.content.appendChild(e),e},Checkboxes.prototype.required=function(a){if(this.isRequired===a)return!0;if(!this.requiredSwitch)throw new Error("Checkboxes.required(): No required button in place.");if(this.placeHolder||this.getElements().length>1&&a)return console.error('Checkboxes: To be "required" there can only be one checkbox in the group and no placeholder'),this.requiredSwitch.checked=!1,!1;this.isRequired=a;var b=this.getElements();return a?b.forEach(function(a){var b=a.querySelector("input")||this;b.setAttribute("required",!0)}):b.forEach(function(a){var b=a.querySelector("input")||this;b.removeAttribute("required")}),this.requiredSwitch.checked=a,!0},Checkboxes.prototype.getElements=function(){return[].slice.call(this.content.querySelectorAll("label"))},Checkboxes.prototype.addPlaceHolder=function(){this.placeHolder=this.add("placeholder","Check a box")},Checkboxes.prototype.createControls=function(){this.constructor.prototype.createControls.call(this);var a=document.createElement("i");a.classList.add("glyphicon"),a.classList.add("glyphicon-minus-sign"),a.classList.add("fl-grey-btn"),a.setAttribute("alt","Remove one of the checkboxes");var b=this;a.addEventListener("click",function(){var a=b.getElements(),c=a.length>0;if(!c||b.placeHolder)return void utils.blinkRed(b.content);var d=a.pop();d.remove()}),this.configContent.appendChild(a),this.createConfigInputField()},Dropdown.prototype=new FormComponent,Dropdown.prototype.init=function(a){this.constructor.prototype.init.call(this,a);var b=document.createElement("div");b.classList.add("full-width"),this.selector=document.createElement("select"),this.selector.setAttribute("name",a),this.selector.classList.add("fl-dropdown"),this.selector.classList.add("form-control"),b.appendChild(this.selector),this.content.appendChild(b),this.addPlaceHolder()},Dropdown.prototype.add=function(a,b){if(!a)throw new Error("Dropdown.add(): "+a+' is not a valid "value" value.');this.placeHolder&&this.removePlaceHolder();var c=document.createElement("option");return c.innerText=b||a,this.selector.appendChild(c),c},Dropdown.prototype.addPlaceHolder=function(){this.placeHolder=this.add("placeholder","Select an option"),this.placeHolder.setAttribute("disabled",!0),this.placeHolder.setAttribute("selected",!0)},Dropdown.prototype.hideConfig=function(){return this.constructor.prototype.hideConfig.call(this),this.selector?void this.selector.removeAttribute("multiple"):void console.error("Dropdown.hideConfig(): Selector not specified")},Dropdown.prototype.showConfig=function(){return this.constructor.prototype.showConfig.call(this),this.selector?void this.selector.setAttribute("multiple",!0):void console.error("Dropdown.showConfig(): Selector not specified")},Dropdown.prototype.createControls=function(){this.constructor.prototype.createControls.call(this);var a=document.createElement("i");a.classList.add("glyphicon"),a.classList.add("glyphicon-minus-sign"),a.classList.add("fl-grey-btn"),a.setAttribute("alt","Remove one of the dropdown options");var b=this;a.addEventListener("click",function(){var a=b.selector.selectedIndex>=0;if(!a||b.placeHolder)return void utils.blinkRed(b.selector);var c=b.selector.selectedIndex,d=b.selector.children[c];d.remove()}),this.configContent.appendChild(a),this.createConfigInputField()},RadioBtns.prototype=new FormComponent,RadioBtns.prototype.init=function(a){this.constructor.prototype.init.call(this,a),this.createConfigInputField(),this.addPlaceHolder()},RadioBtns.prototype.add=function(a,b){if(!a)throw new Error("RadioBtns.add(): "+a+' is not a valid "value" parameter');this.placeHolder&&this.removePlaceHolder();var c=document.createElement("input");c.setAttribute("type","radio"),c.setAttribute("name",this.name),c.setAttribute("value",a),c.classList.add("fl-radio-btn");var d=document.createElement("label"),e=document.createTextNode(b||a);return d.appendChild(c),d.appendChild(e),this.content.appendChild(d),d},TextArea.prototype=new FormComponent,TextArea.prototype.init=function(a){this.constructor.prototype.init.call(this,a);var b=document.createElement("div");b.classList.add("full-width");var c=document.createElement("textarea");c.setAttribute("name",a),c.setAttribute("rows",5),c.classList.add("fl-editable"),c.classList.add("fl-text-area"),c.classList.add("form-control"),b.appendChild(c),this.content.appendChild(b)},TextArea.prototype.setTitle=function(a){a&&this.title&&(this.title.innerText=a)},TextBox.prototype=new FormComponent,TextBox.prototype.init=function(a){this.constructor.prototype.init.call(this,a);var b=document.createElement("div");b.classList.add("full-width");var c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("name",a),c.classList.add("fl-editable"),c.classList.add("fl-text-box"),c.classList.add("form-control"),b.appendChild(c),this.content.appendChild(b)},TextBox.prototype.setLabel=function(a){a&&this.title&&(this.title.innerText=a)},xController(function(a){var b=new FormBody,c=new FormFabric(b.element);a.classList.add("fl-form-builder"),a.appendChild(c.element),a.appendChild(b.element)});var utils=function(){function a(a){a&&a.classList&&(a.classList.add("fl-blink-red"),setTimeout(function(){a.classList.remove("fl-blink-red")},1500))}function b(a,b){var c,d=+new Date,e=a,f={},g=!1;return function(){var a,h=+new Date,i=h-d;c=arguments,i>e?(b.apply(f,c),g=!1,d=h):g||(a=e-i,setTimeout(function(){b.apply(f,c)},a),g=!0,d=h+a)}}return{blinkRed:a,throttle:b}}();
//# sourceMappingURL=fl-form-builder.map